let signedInfoXmlFormat = '<SignedInfo><CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315" />' + '<SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256" />' + '<Reference URI="">' + '<Transforms>' + '<Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature" />' + '</Transforms>' + '<DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256" />' + '<DigestValue>' + digestValue + '</DigestValue>' + '</Reference>' + '</SignedInfo>' ; let firmado = signatureXmlFormat + signedInfoXmlFormat + keyinfoXmlFormat + '</Signature>' ; let '</ECF>' let 0 return xmlSinFirmado; } //Permite convertir a Pem private let let let let _a = this _a.commonName; return { pemKey: pemKey, pemCertificate: pemCertificate, commonName: commonName }; } // Obtiene la llave de un p12 private var { bagType: forge.pki.oids.pkcs8ShroudedKeyBag }, var pkcs8Key = keyData[forge.pki.oids.pkcs8ShroudedKeyBag][0]; if typeof pkcs8Key === 'undefined' pkcs8Key = keyData[forge.pki.oids.keyBag][ 0 ]; } if typeof pkcs8Key === 'undefined' throw new Error 'Unable to get private key.' } var /\r\n/g return pemKey; } 8